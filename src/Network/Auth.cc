// Copyright 2024 Maicol Castro (maicolcastro.abc@gmail.com).

#include <Luna/Network/Auth.hh>
#include <cstdint>

using namespace Luna::Network;

// https://github.com/openmultiplayer/RakNet/blob/e04879f77b04a5415daa08241d2eab027c933a73/SAMPRakNet.cpp#L620
static const struct {
    uint32_t Recv;
    char const* Send;
} AUTH_TABLE[256] = {
    // 12
    { 475714777,  "E34C0A3756936F4852CC6EC0035F5EF66562D477" },
    { 895366396,  "492927CD4E61C8BB6FEF9DF926C1C2D9EC925359" },
    // 14
    { 194911786,  "B7E04B553D665F0C4F59542491B45B9D2EB47248" },
    { 333282793,  "3958D8F27C3E2CCF23DF30EF9826B8B4AE012345" },
    { 339044361,  "35E8537F84FD7C1F0E2D5C3A1B50C39C6FFD34C3" },
    { 454923244,  "CA8F2BD50C66A24FDC14506452DE038FC119D40A" },
    { 532823450,  "D85E24B5C5E0F8E9BA5D07A261ECA3F26EE40D48" },
    { 608662388,  "73FA1B06A7159BF92AFB50FA455A0B82A28FF548" },
    { 1269267289, "D66A8D7BC90A297726DFED969FDAA6EF19939864" },
    { 1409278824, "457B799050C64D09B68E2FDDB2F40BD0F7216A30" },
    { 1437735460, "D830239C33F736942B7FF97B7B12137465CEC08E" },
    { 1464337700, "7A11536F824A625D4D88CC5EFC754F52F6C86AEC" },
    { 2087318920, "7AFAF784571E4BEA4CE07906B62A2D5F2D04C03B" },
    { 2218500812, "4E50D5C757887821522338185A32DC1A2B263D5E" },
    { 2224800613, "6E87E67009B19014A2714DB2E174474B3A5C303F" },
    { 2291629131, "E2089098F1CE0AB3729F62AFAE75F29EE5B88624" },
    { 2781658013, "4E186672D64DB2A8028F0AEB6D3A767BB1F59CD1" },
    { 2837077674, "21334344D203C35901E4793CB60F55C04FC89058" },
    { 3064431317, "A17C2F9CE17F09BA78D846F8C8CFC7F7079C23B2" },
    { 3585944049, "C6183E48AADE981C56FE4F73AAE7CA43637B8EBA" },
    { 3639760291, "7AC50947A514153C84515C96C8B66354B11745C4" },
    { 3838022220, "8521241F6EC0D396A9D50C1842DDBB9109167565" },
    { 3920568679, "AF76765DFA4A47E500092C55101D73CD31ECFB89" },
    { 4152723822, "0FDBD2E992763F49120A5B424BDE97D578303FEF" },
    { 4259322839, "2731E85667DF3DF9255EEBEC8FB1D4830939B8EA" },
    // 15
    { 23005675,   "24035C6EC8AF3CEE8C58F90249C717BFE51D8338" },
    { 24513944,   "918A09C3659C45882555011270B8460CE6EC9F92" },
    { 54201830,   "029A6C2159DF3195513211DD5B7331A580AEA502" },
    { 154248052,  "FDAD5B7B2C5DC84BE49F07FD03C80EF634EA9C82" },
    { 165498450,  "C460C7370F9630FDC5DCE592E9D4673CBA0FA769" },
    { 222188464,  "5BCF5C415256E41CF8BD9F5BE2A42F7AD7996750" },
    { 275867297,  "4454AF95AF5B8460D4D5BD1798E2656ED174FB2F" },
    { 291436353,  "674AF510B26CB1F8E1835B396945C911CDB0F7F0" },
    { 398605466,  "7F370CE0F99A3CAA9929A915DAF9175B7EC5437D" },
    { 399936639,  "752C905020077D8F524A8616402E12DDCBDE351C" },
    { 611099731,  "D94EAFF471FE5CC6976909F4DCD77AC2AA765D88" },
    { 629761484,  "18A1FC58F1A5DFBEFA1281DF46090A7A50E03C48" },
    { 640782513,  "E66595B115971A6AF745938D5D426AFBCD9FEA6D" },
    { 703508374,  "24BA1E079FF6BB3CF7F57DC63E1FBCA5C1C6A2F8" },
    { 741800695,  "180ED6A653ECBB56A5DC9DD5E4FD862FEE792990" },
    { 756616504,  "5BCA55150CE749AED97A0CE7B1A7EB205735E7E7" },
    { 810681179,  "173AF0F1EE5EB356140E40182583F8C4E6C873E3" },
    { 820302733,  "BF6A3C57226D5BE61C0C20FD17FC935E37C57E64" },
    { 852103182,  "96FD906C1EABF6570C4E43B5C1D31149CDB09C85" },
    { 894749906,  "453B2549AF80225BC7F638DE7276DD0857B8032F" },
    { 946391456,  "AAF19B7400E7C12EFB19E0D58F300A9A51B7ADAB" },
    { 969907183,  "7365966472CDB73AC8D4E42C02838C6FFA5C991F" },
    { 973213490,  "F097275236912E370955E54509C0E554D28A45A5" },
    { 1010683364, "15E28C2087874A7076425385572F92817436F8C3" },
    { 1114211526, "5DEEBFA4CB6E03CD16C063E211D20640FACA4B4A" },
    { 1120350055, "F8B0FD3504390C79256C984B7BADA1806D94EE3E" },
    { 1183559673, "4867AEC4BC3405FEB6D1D612F0FE5FBACED0FF64" },
    { 1188606487, "53BB915F5ECEED59F0C92AB903135E9FDF60BF6C" },
    { 1246403892, "B0BF1A5B7A3A0586917A84315D210B7DDB652FBC" },
    { 1252622251, "BA59F7B390B0D49CFC7E12D4A835AA337DF01F5E" },
    { 1349074197, "8FD27820677C48DF887A94BE76147ADACFE32513" },
    { 1415402495, "69FC69EE7C95738F917AEA73D1FB6B907AD91953" },
    { 1539771755, "8D684C13AC99106FD8FEA3E5626C12A6B97CD01A" },
    { 1555709613, "0C2B97FC56DA10ADBB6D47A4F079ECDF7EA8BB95" },
    { 1556959559, "B62D5A37BC45ECC0C374C4905629F0D9392715C1" },
    { 1575298052, "E4CAADA710179666EA035F509681F9B8DE7FFCFC" },
    { 1610444651, "0C98F3E92244EA1C40E537D706AE3956BAAA76DE" },
    { 1628078984, "E15406041F2A256A2209B47539E3FE5A5793CC39" },
    { 1662173017, "83EDD7778BFB69DA52B86B3B5767726DD204DB34" },
    { 1695582867, "B64DC756FD081BBC106EA069708B3C6596222898" },
    { 1731627289, "B8EDB6CC12E29A032A80A5F98D695B182B32556D" },
    { 1746006029, "5CFA7F8A5334D8F5AE4867A28A25586AEC4AAF4F" },
    { 1783046989, "BF43CD93D89C5285E27B84FE8EFB4E1AC501A3B1" },
    { 1838216396, "C1B8BDC35596EFB40826BE0DF6A7303A1459AD72" },
    { 1868133778, "152AB05E3464C03EA308DF51B6D4771FAA8E2F8B" },
    { 2018124178, "91A4F3384BE48B758F14181BE065B4E523EA20E3" },
    { 2045840230, "0A5C6E3E271360346C6FB1BF9E580EDC758525AD" },
    { 2074163305, "52E6215ABA22F11801D868BEE5E0D1C706371D31" },
    { 2231527696, "3FA7B99D35480465EC276CBA5B287595BE34BE98" },
    { 2248133307, "89A10043BFA4FBAEC3FB4C4B8B30FC00B51C5EEF" },
    { 2258700849, "3480702908DB81BEBD2FF6DB0A7A3A276DFAB13D" },
    { 2266864525, "AC4E454B5D51815B18867CA04560EB5AD8838D7E" },
    { 2268255866, "77E63FDEA5EDD8B5ED8563D0F38E0E83CDECE996" },
    { 2428887163, "CB2084E4290C216DF0D0AD8A445A362F8799648A" },
    { 2439551629, "FD7E61C06C9036F8845E982C8560964B8A143E87" },
    { 2447964437, "133F545A93DAC8A15DB200C6C0A21090D38541A0" },
    { 2511992118, "D1080D41AD614649282887E4001C93AAEDBCA570" },
    { 2563880137, "259F8C16BA6468B3BE6C4456E5ECAE85574CE4FB" },
    { 2582930822, "AEF468EE84F95E064042E7B6D0DCE0608677401A" },
    { 2618470772, "38C0E472DB303430DED2205FAE4596AF08603580" },
    { 2719876361, "D2A4C61BB6D9FAB47FF4732B70497FAD91BB7FC2" },
    { 2755463590, "B51D6195915BBA8A5CAC1581C6423B83E1B9D21B" },
    { 2759090717, "8426C0C07C699A93B12CF0B53661541726F6A555" },
    { 2761644733, "6E0893E674F14528FABB970FCF592E3F94C3DCFA" },
    { 2764832681, "DF1753449635CD25656BCB47933BF05ABDF952C5" },
    { 2799964115, "A7BF359223A37F0A3455636EBCF249E92E8A7EE8" },
    { 2810447078, "99C56BD48BCD93D555D708A1D78E3F4F259B4A79" },
    { 2892069375, "76679E3836E8EAED90B6F10B121B52FE4F03339B" },
    { 2910164647, "193BC88CFAE3B57050BEAEA9E8AFA097BF8F3B5C" },
    { 2957327759, "19B390F6FE5CB0192C289F53706C1542FB0A0D39" },
    { 3076602603, "2E680524E8873363574778D78EFFE8C4D690D7A6" },
    { 3155801616, "EC664F610315BD0B049A6A42B7003BBAFF99CAF1" },
    { 3199809457, "F21D89EB25B1263DE5871A60E9407C7A98D0381D" },
    { 3251974497, "CA0BC7D627C3B33F1834189D9183F2F19A2D233F" },
    { 3323661737, "0D273519B1154DB6FA1DCF4CE2752D0A69D96218" },
    { 3465738260, "433558B16219F93CCD61E4CC8DE618DE407607C1" },
    { 3533548031, "C2F2FDF47C6BD12310FCDB3B564A5AAA4EE4C627" },
    { 3623198180, "8143B0D90476820C30FBACD470D2C433B229CB84" },
    { 3748052976, "B8F3114F4DA2779075CBA5574D4B6BDDEEC3CF7D" },
    { 3756946739, "EBBD29EFED75C5C5D2816F86B737FC4F5021A231" },
    { 3799977225, "88E9316C6F822752A71A3337D90F49D29AD47298" },
    { 3872789020, "EBF13AE17C7EAF5903E938B21519C138B6109E28" },
    { 3879564080, "D9412F235647BAA582089C6F66817F8B8811C057" },
    { 3886394244, "E239256C1CB03967F46C9B24005FC8C0E20B1A0D" },
    { 3889555474, "E20C4BEB9A4166188C49D8AC7715E759902AF87B" },
    { 3897839697, "CA08EE157A0B0A775C3FC516762EE4EDBE90A0B3" },
    { 3901171914, "6F748D92EC9D010F16AEFB57759C678B4060C7E5" },
    { 3943696937, "64CBAFE90E809320092A1FB98E1A14572C50CFEF" },
    { 3966642114, "A24C762722180B42D75D32641BA1F5BD5705498A" },
    { 4114246111, "369C3F95D1A57DA57655B39807C47D685AA8BFC7" },
    { 4143391786, "D2BC447A6745048E7E91E6A9A573773B406C0EB6" },
    { 4192867031, "E3926F6FFC7DDF8AEE8C6F41FFE706302A1470CC" },
    { 4228049018, "A55ACFA72989539D611ED1C03481C531D2689A7A" },
    { 4278712060, "39E962FC90673235224A76D48C8CA530CC2B9A6C" },
    { 4290322946, "CD8856BDA216335F3D275587E57D75E62FC8ED3A" },
    // 16
    { 50200863,   "FBC5E2EE7F584506302A9AC668275D84079AC51E" },
    { 59142972,   "7C322DB43AC0B97EBEA4881EF138B9DC528DC346" },
    { 64806808,   "375D20FBD0A05DECCAB08367E15E5FA5A77A3729" },
    { 73486648,   "9EDF0B6A2D06A6BB4DD592CC4FB910F5C071BF5B" },
    { 140161103,  "E72876080826370E4348ED487BAD25175893AA48" },
    { 270799653,  "19C722C8D0EE4D1D228019AD003FBCF173AB05A3" },
    { 380992697,  "AD777E54C165C0A09871C37DE42EEFE09B81DFF3" },
    { 446266636,  "A13E3C1959CB65EF9E524BD24F0FDCF8DD11DA1B" },
    { 451048451,  "F44374A4DBE562211BA7179F19CC8E1861220218" },
    { 481684504,  "45B0A24B64A678C5B6A434FCE00016C49A1C75F6" },
    { 583006553,  "0DB9491C3D55DED81E3A3C72E40E88C8919758AE" },
    { 631785467,  "34C6031CEE4EE12BD62EB2F3472D56CA74E34D0F" },
    { 715825596,  "E163DBDE328DC9A9F43060C7DF162D157B10400A" },
    { 721993677,  "50132A03C5931C67565600527B145BF736F03238" },
    { 747372268,  "7CE44A1AB70E70334A040BB97948F90F7529CA08" },
    { 753107449,  "419C59FE61200D6E59F0774C7E4A0B9FEB0D8543" },
    { 785973476,  "45841042BC967C22FDAE981407BBB57A7081DD45" },
    { 792260641,  "6A244AC02399BAC7D4ABCB6B87199AEF377B0177" },
    { 820781874,  "F191F014E3204211EBB782445473F6637C277EDC" },
    { 857417849,  "6DAF4BB4110666179DD2278C364D544955CF8F67" },
    { 873755291,  "3EEC56001D9EA511C1F4CC8BBE830BC47BD8BB0A" },
    { 883389728,  "7704AC660058B05F1A3ECC308FA91A18FFFF84F9" },
    { 921437383,  "B105A621B98C4DCEC677119FF8FB02237B662156" },
    { 927703764,  "1AD6B4FCEC9D0D05B4EFEFA11200B4D9892C6895" },
    { 960404679,  "E188A468F6A8EE07441C4A1AC63FB29F8D53951B" },
    { 1004659694, "B8EA6126891D8ED83D8716DAE90D9D297BBF6220" },
    { 1024656108, "AD3D181D621E4778E4CE285FE5D177A31375F947" },
    { 1040090071, "B028F73A7B37AB5EF9B990ECA397C78841B7A086" },
    { 1056074269, "62A24EA43DC2E7FDFE89AAB5F7B587EAD0771DC8" },
    { 1118046678, "FB508D6CDDAFE62F088ECC07834BA165A6D9484B" },
    { 1127782997, "1BFA8AD640401259216B04A43F160A6810866163" },
    { 1153794067, "50100256B8B3B827E2932017333B11F87390D3ED" },
    { 1174213024, "E60B8A2D516AA68759272E807052FD3862D7B75C" },
    { 1191740892, "92CDAB5A10FAFB4702DB000171DB011451F6C504" },
    { 1195895304, "334A90A161C6774DACA6C7C5E2D920D85D236056" },
    { 1247517723, "CFC5A84B3CF3D04D1FDEE82B91972B90A5D8EAEE" },
    { 1250673212, "BC293BD1438D6FB4C10D1A5BC778A88B9BD6C99D" },
    { 1279656499, "FF802A0B2398CCCD3930E8C87F1C8A8DFCB82011" },
    { 1284106256, "8776CC093D240126E58F125BE7858E259AF8B5FF" },
    { 1284479298, "78AF9E59782B0F590464CF9936138798B5F2CF48" },
    { 1297377122, "6D3B25F5B6A0DFD6146AF305781D34E57C5D682C" },
    { 1340204621, "9A05010BF879AD36D43327DAD911382D50903FF7" },
    { 1386780940, "95260B015F7763AA5111E2460BE7DAE82964C709" },
    { 1399253276, "25DFE45F13CEC422AF94A4F8C4D5933CFBD855B9" },
    { 1493969576, "C848B7B9C0F4B31A84926C0A48E3A012E2FAB253" },
    { 1499220233, "66B37BEFCF9399108C27DC72208E00AB827A7DD2" },
    { 1631061299, "5E5DE0E176014FEF75047CF57C62610D59F2AF59" },
    { 1641833160, "D8A6A2017ED4EC0717AAE74CF6409D6814E13052" },
    { 1653426539, "132770E4744F6E78F2CBB4D3F3638EC05D7EA79D" },
    { 1786409357, "84B3C7FD6C1A4E8FC59297ECDFC286C298C246A5" },
    { 1788120828, "B126F73BDA26767C36DF0261E10C5556B96C9379" },
    { 1808438375, "982B1A75CCB87E2AD7EAB23F149A7FEB785BE875" },
    { 1861276575, "D4F20851FBB40B1606436C0B9D3B470DCC5743B5" },
    { 1881836318, "246E6FF71D6CA74ADD99363E464A8F30BEEC04AC" },
    { 1882591014, "C92B05E20B8728F1C9A337920EE73A9810CBAF2E" },
    { 2027881041, "F80C175C517ADDAF3C70E4F3F884026081A0B0EC" },
    { 2033102292, "43A554222D382FA10936FA1A296A47CCF7A4726A" },
    { 2058847000, "AFD221F0E28AB16BF0F3E9570034AB8F949F10FB" },
    { 2074832067, "87F8E07CE86EBCDD2B98E949F0C3CE79A7258DD7" },
    { 2084073804, "80DD8A137A0F8D2B3027DAE1D7B0F2A22DC02BB3" },
    { 2112455843, "DE4DB227F4891DB3B5C0C9ACCC7991AAD3780CFA" },
    { 2169680891, "5F574D100C5906595F1A53E1CAEDAE8B7D75321E" },
    { 2222437453, "3411A0F24E8F3B93BC5E6533044B8423B86A2CDF" },
    { 2234330427, "FCC9B7CE8F1249F82BF6E98A48EED5393110090F" },
    { 2234422233, "2CB76D8A0993DE62D0C108D6814D4F7DE0D4C8D1" },
    { 2260418223, "085DC16D7C4A3975337FCA16C30E785CADDFDEFE" },
    { 2368726262, "F835ADB252311789710633D89D13AEF8742D342A" },
    { 2396730772, "50018A8C9C4551E01BE38DC675460357544E28B3" },
    { 2453966605, "940F34C2D41245E4524E1D5434463B5F8AECEE76" },
    { 2458806591, "56EF5FC757D8080D0C33C00C2F96FAA00948734D" },
    { 2469691646, "A5737572A642FDF51B111E04E4E2F48C3336C4AE" },
    { 2487020883, "9C6AE1A930350CB45517994FC5B3D918F5003A96" },
    { 2493692973, "269D40DF5E98637F665FFDEA8532ED5E02F360DB" },
    { 2503890871, "90D62A04AC0B96827FB0EA67514D3B9A1E3BF91F" },
    { 2519979363, "E4F9B6827BE31BDE47454E28560A9FAD8E3CDBA0" },
    { 2552357504, "93369612310EB002BFD93634D17B7A0BC929B30D" },
    { 2642486064, "63D38A575B69E435526A49EB0B2BF5376A903A7C" },
    { 2651191222, "9383AB215ED09F2B996F7DD905E6C69C4D6F734B" },
    { 2651197648, "334E33CEA02105B5AB9DD4290D20EF1CE2FD7955" },
    { 2675419201, "A3D6F3D6B29810463835A320840D9E8482560BF1" },
    { 2697680722, "D64EC2AF19D96CC95D97CFF37C88463DC555EB1B" },
    { 2713029806, "18CFC66AB764D902910E7A1C6300442CE501CFBF" },
    { 2798512487, "1B08562483516AD6B34E38131DC148742685D8AB" },
    { 2814611979, "6BA21F9467E0D25D2A940E5B8332367260799462" },
    { 2906162182, "5444893CD7F73746EFAD8BF8133E5D57AAE6927B" },
    { 2919556384, "B491A64DE34519D96E0D428880AD86B0B0F0735F" },
    { 2996332206, "FC4F1E495122C86D1605F2C720D307A4F23DA704" },
    { 3006012373, "E88733B15DC9396B1B20EF094771CF44C818A69A" },
    { 3027972269, "C61CAD6746318287AF0BF5B2003868AF6982003C" },
    { 3054679663, "FA52DB6492A87A0078ABD837468A4AD7B4B7E6ED" },
    { 3066723873, "6DDFA1F4595A70906C71958B9CBF06582ECC8D3D" },
    { 3074101306, "74A8F21FB34D6A05C1C08B6BB8DE5712913E8A54" },
    { 3089883227, "EE1869A8D0AF990C1D58EF7C683CC6E23BCF0BB1" },
    { 3108511086, "ADC16DB34679B031D4B5BBEE184B50083BB9B8A0" },
    { 3110705413, "B9B72B3FA9C877AF292087F765112F859B72C64D" },
    { 3120596323, "6C3F004F320AE3B70FA8BAB7EEB8D66A176497F6" },
    { 3149592361, "C2AE658442E941A1ADEFA2C96DCA9E1D3B97A23E" },
    { 3164419788, "AA66E00E75CB893196A84DBC29009BF614C66084" },
    { 3170082693, "1E385E9446FB0605BA96D9DB4A603304DFEAF90B" },
    { 3170708425, "2DE29755238B3769C6565C379652B98C1BE612B4" },
    { 3206185866, "DAC1332B09E674A4A619D5A1A1855B17A4D97F8D" },
    { 3229727479, "73D1386CBC760FA57BFD1504E47FDEA1F1EA59C6" },
    { 3303883407, "358D0593F129EF431EDA37C1B93478A39CA49846" },
    { 3342520985, "C51B71C95640001B3A91ADB393C90EEB3C60E7DB" },
    { 3373871591, "97E4E8B37712D2E6D9E0BEF95CD95951116381FB" },
    { 3456748084, "50E366B9D4EF5EFDBFD7BC128FE9F339B19CB873" },
    { 3457345928, "74E2C35A7E54AFAC89209B4D0579877F5DA98F13" },
    { 3494377181, "2F2E103ECAD7EA2E5EADC0DD12DDD05898C934B4" },
    { 3555231352, "64EAD04A4FD68F0DB9A33F87FC3167C666BCD32C" },
    { 3556492695, "1A29C1131308250744818611B8329117EE594C1B" },
    { 3582249183, "03679F4624B21CF0979722545B783845E3398306" },
    { 3609993560, "6BE2A3D98D0A8C09417F42CBDDC358219EB33C92" },
    { 3649529308, "0EC322D4E644AB352B8C990EC66F9D6C707C8A1A" },
    { 3651248161, "A309F3B06CB2316FEB4A67E1D3953D63F51D00EA" },
    { 3674912248, "D9C08A2FA2D0AC2A8FE53CCEBD4F2EC31474B9BA" },
    { 3697704908, "144A22F14F2EA79A588D22D78B3F1E462D152896" },
    { 3723796706, "3F22A66F651B682C24DEC04FE0F4006E8CFD154D" },
    { 3723883302, "282B4A757C5C4E1DDBFA0D1C39EA53576AB91399" },
    { 3745429388, "84DE0DD44B8155E58D8E324CBDE2D69E6FC6DD21" },
    { 3800988426, "D8E1BF3412E8172CB3710A03F0CAB73E009565DF" },
    { 3812131668, "59C0C177142EDCA420714A730E662CA182EAD9AC" },
    { 3814156745, "2393D160295BD5A03F42CA1D1932C0D8DE940FC9" },
    { 3876417948, "C6F997E2A56407A82F384DB2BB23041B1252C680" },
    { 3902731009, "0A392FB24304303AE7DF4C83BAAADBFAF9E394BC" },
    { 3914323549, "2B25F4B09D664BD72971367601F92109D3B6C7AB" },
    { 3937882315, "45AB65DF7D64D902A3B130CEA3F9529AC4F260B6" },
    { 3942886627, "C026C91160AFA9B715D50328CE3B71C802E59EEA" },
    { 3964334987, "A56B5A1E4F8938B7B02E043CD0E02E1AD92E080B" },
    { 4005505543, "2C1BE06F66EF376632810A872519BFD18F2CEA6F" },
    { 4016979322, "5CDB078FCFEB311A1B174A9EA47B6BA8875A0CA3" },
    { 4071389185, "1ADFA13B14C69694CE4DA9F94EF6E5AF83BBF020" },
    { 4138746276, "EFCB215CAF75CCECE4925FBA0192F6F6ACC9F9D6" },
    { 4154186725, "98DCACE879EA22A55AAEB4DF557F0112750538C0" },
    { 4243559791, "1A1C51732728D88F55C8AC2755E16B2C72081383" },
    { 4257342080, "C341AC8EAE4E3433FA4F63F7A4521FBEC4E33BB0" },
    { 4293517949, "F9E62B21E68DEF3CA5304096E80A45764A6CBAA6" },
};

static uint32_t FNV1A32(uint8_t const* data, size_t length) {
    constexpr uint32_t OFFSET_BASIS = 0x811C9DC5;
    constexpr uint32_t PRIME = 0x01000193;

    uint32_t hash = OFFSET_BASIS;

    for (size_t i = 0; i < length; ++i) {
        hash ^= data[i];
        hash *= PRIME;
    }

    return hash;
}

static std::string_view GetAuthKey(uint32_t recvdKey, size_t from, size_t until) {
    while (true) {
        size_t index = (from + until) / 2;

        if (recvdKey == AUTH_TABLE[index].Recv)
            return std::string_view(AUTH_TABLE[index].Send, 40);
        else if (recvdKey > AUTH_TABLE[index].Recv)
            from = index;
        else if (recvdKey < AUTH_TABLE[index].Recv)
            until = index;
        else
            break;
    }

    return {};
}

std::string_view Luna::Network::GenerateAuthKey(std::string_view recvdKey) {
    if (recvdKey.length() < 12 || recvdKey.length() > 16)
        return std::string_view();

    uint32_t recvdKeyHash =
        FNV1A32(reinterpret_cast<uint8_t const*>(recvdKey.data()), recvdKey.length());

    switch (recvdKey.length()) {
    case 12: return GetAuthKey(recvdKeyHash, 0, 2);
    case 14: return GetAuthKey(recvdKeyHash, 2, 25);
    case 15: return GetAuthKey(recvdKeyHash, 25, 120);
    }

    return GetAuthKey(recvdKeyHash, 120, 256);
}
